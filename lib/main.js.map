{
  "version": 3,
  "file": "",
  "sourceRoot": "",
  "sources": [
    "../src/main.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\n'use strict'\n\n#===========================================================================================================\nH                         = require './helpers'\n{ Template\n  gnd\n  hide\n  create_validator\n  # get_instance_methods\n  bind_instance_methods\n  nameit\n  push_at\n  # pop_at\n  set_at\n  debug\n  warn\n  help\n  rpr                   } = H\n# E                         = require './errors'\n# optional                  = Symbol 'optional'\n\n\n#=========================================================================================================\nclass Nfa_error                           extends Error\nclass Arity_error                         extends Nfa_error\nclass Named_arity_error                   extends Arity_error\nclass Runtime_arity_error                 extends Arity_error\nclass Positional_arity_error              extends Arity_error\nclass Not_implemented_error               extends Nfa_error\nclass Signature_error                     extends Nfa_error\nclass Signature_disposition_Error         extends Signature_error\nclass Signature_naming_Error              extends Signature_error\nclass Signature_missing_parameter_Error   extends Signature_error\nclass Signature_cfg_position_error        extends Signature_error\nclass Value_mismatch_error                extends Nfa_error\nclass Type_error                          extends Nfa_error\nclass Argument_type_error                 extends Type_error\n\n\n#===========================================================================================================\ninternals = new class Internals then constructor: ->\n  @pod_prototypes = H.pod_prototypes\n  @gnd            = gnd\n  @push_at        = push_at\n  # @pop_at         = pop_at\n  @set_at         = set_at\n  return undefined\n\n\n#===========================================================================================================\nclass Normalize_function_arguments\n\n  #---------------------------------------------------------------------------------------------------------\n  constructor: ( cfg = null ) ->\n    if cfg?\n      throw new Not_implemented_error \"Ωnfa___1 configuration not implemented\"\n    bind_instance_methods @\n    return undefined\n\n  #---------------------------------------------------------------------------------------------------------\n  nfa: ( cfg, fn ) ->                                                   ### Normalize Function Arguments ###\n    switch arity = arguments.length\n      when 1 then [ cfg, fn, ] = [ {}, cfg, ]\n      when 2 then null\n      else throw new Runtime_arity_error \"Ωnfa___2 expected 1 or 2 arguments, got #{arity}\"\n    #.......................................................................................................\n    ### TAINT do this in `gnd` ###\n    unless gnd.pod.isa cfg      then throw new Type_error \"Ωnfa___3 expected a POD, got #{rpr cfg}\"\n    unless gnd.function.isa fn  then throw new Type_error \"Ωnfa___4 expected a function, got #{rpr cfg}\"\n    #.......................................................................................................\n    cfg               = { gnd.nfa_cfg.template..., cfg..., }\n    cfg.template      = ( new Template cfg.template ) if cfg.template?\n    gnd.nfa_cfg.validate cfg\n    #.......................................................................................................\n    { names\n      q_idx\n      q_ridx        } = @get_signature fn\n    arity             = names.length\n    fn_name           = fn.name\n    #.......................................................................................................\n    validate = if cfg.isa? then ( create_validator \"#{fn_name}_cfg\", cfg.isa ) else ( x ) -> x\n    #.......................................................................................................\n    return nameit fn_name, ( P... ) ->\n      if P.length > arity\n        throw new Positional_arity_error \"Ωnfa___6 expected up to #{arity} arguments, got #{P.length}\"\n      #.....................................................................................................\n      if gnd.pod.isa P.at q_ridx\n        push_at P, q_ridx, undefined while P.length < arity\n        ### ATP, `P` holds `arity` arguments and there *is* a POD in CFG position (which we assume to\n        represent CFG so we can make a copy, filling in template values): ###\n        Q = set_at P, q_ridx, gnd.pod.create cfg.template, P.at q_ridx\n      else\n        P.push undefined while P.length < arity\n        ### ATP, `P` holds `arity` arguments and there *may be* an `undefined` in CFG position (which we\n        assume is replaceable by a newly created CFG instance with template values): ###\n        if ( P.at q_ridx ) is undefined\n          Q = set_at P, q_ridx, gnd.pod.create cfg.template\n        else\n          throw new Argument_type_error \"Ωnfa___7 expected an optional POD at position #{q_ridx}, got #{rpr P.at q_ridx}\"\n      #.....................................................................................................\n      ### Harmonize values: ###\n      for name, idx in names\n        continue if idx is q_idx ### skip over CFG object's (`Q`'s') position in P ###\n        if ( P[ idx   ] is undefined )  then  P[ idx  ] = Q[ name ]\n        else                                  Q[ name ] = P[ idx  ] ### pos.arg:s other than undef. take precedence ###\n        if ( Q[ name  ] is undefined )  then  Q[ name ] = P[ idx  ] ### ensure all sign. names are set in CFG POD `Q` ###\n      #.....................................................................................................\n      return validate fn.call @, P...\n\n  #---------------------------------------------------------------------------------------------------------\n  get_signature: ( fn ) ->\n    this_cfg_q_name = 'cfg' ### TAINT pick from @cfg ###\n    ### thx to https://github.com/sindresorhus/identifier-regex ###\n    jsid_re   = /// ^ [ $ _ \\p{ID_Start} ] [ $ _ \\u200C \\u200D \\p{ID_Continue} ]* $ ///sv\n    #.......................................................................................................\n    signature = fn.toString()\n    signature = signature.replace /// \\s+ ///svg, ''\n    signature = signature.replace /// ^ [^ \\( ]* \\( (?<parens> [^ \\) ]* ) \\) .* $ ///svg, '$<parens>'\n    names     = signature.split ','\n    #.......................................................................................................\n    q_idx     = null\n    for name, idx in names\n      if jsid_re.test name\n        q_idx = idx if name is this_cfg_q_name\n      else\n        throw new Signature_disposition_Error \"Ωnfa___8 parameter disposition not compliant: #{rpr name} in #{rpr signature}\"\n    #.......................................................................................................\n    unless q_idx?\n      names_rpr = names.join ', '\n      throw new Signature_naming_Error \"Ωnfa___9 parameter naming not compliant: no parameter named #{rpr this_cfg_q_name}, got #{rpr names_rpr}\"\n    #.......................................................................................................\n    switch q_idx\n      when names.length - 2 then q_ridx = -2\n      when names.length - 1 then q_ridx = -1\n      else\n        throw new Signature_cfg_position_error \"Ωnfa__10 parameter ordering not compliant: expected #{rpr this_cfg_q_name} to come last or next-to-last, found it at index #{q_idx} of #{names.length} parameters\"\n    #.......................................................................................................\n    return { names, q_idx, q_ridx, }\n\n\n#===========================================================================================================\nnormalizer                = new Normalize_function_arguments()\n{ nfa\n  get_signature         } = normalizer\n\n#===========================================================================================================\nmodule.exports = { nfa, get_signature, Normalize_function_arguments, Template, internals, }\n\n"
  ]
}